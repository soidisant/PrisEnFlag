<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Pris en Flag</title>
    <link rel="icon" type="image/jpeg" href="/logo.jpg" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  </head>
  <body>
    <div id="app">
      <!-- Language Selector (visible on all screens) -->
      <div class="lang-selector">
        <button id="lang-en" class="lang-btn active" data-lang="en">EN</button>
        <button id="lang-fr" class="lang-btn" data-lang="fr">FR</button>
      </div>

      <!-- Loading Overlay -->
      <div id="loading-overlay" class="loading-overlay hidden">
        <div class="loading-content">
          <div class="loading-spinner"></div>
          <p class="loading-text" data-i18n="loading">Loading...</p>
          <div class="loading-bar-container">
            <div id="loading-bar" class="loading-bar"></div>
          </div>
          <p id="loading-status" class="loading-status"></p>
        </div>
      </div>

      <!-- Start Screen -->
      <div id="start-screen" class="screen">
        <div class="flags-bg">
          <span class="flag">ğŸ‡«ğŸ‡·</span>
          <span class="flag">ğŸ‡§ğŸ‡·</span>
          <span class="flag">ğŸ‡¯ğŸ‡µ</span>
          <span class="flag">ğŸ‡©ğŸ‡ª</span>
          <span class="flag">ğŸ‡®ğŸ‡³</span>
          <span class="flag">ğŸ‡¬ğŸ‡§</span>
          <span class="flag">ğŸ‡®ğŸ‡¹</span>
          <span class="flag">ğŸ‡ªğŸ‡¸</span>
          <span class="flag">ğŸ‡¨ğŸ‡¦</span>
          <span class="flag">ğŸ‡¦ğŸ‡º</span>
          <span class="flag">ğŸ‡²ğŸ‡½</span>
          <span class="flag">ğŸ‡°ğŸ‡·</span>
          <span class="flag">ğŸ‡³ğŸ‡±</span>
          <span class="flag">ğŸ‡¸ğŸ‡ª</span>
          <span class="flag">ğŸ‡¨ğŸ‡­</span>
          <span class="flag">ğŸ‡µğŸ‡¹</span>
          <span class="flag">ğŸ‡¦ğŸ‡·</span>
          <span class="flag">ğŸ‡¿ğŸ‡¦</span>
          <span class="flag">ğŸ‡³ğŸ‡´</span>
          <span class="flag">ğŸ‡µğŸ‡±</span>
          <span class="flag">ğŸ‡¹ğŸ‡·</span>
          <span class="flag">ğŸ‡·ğŸ‡º</span>
          <span class="flag">ğŸ‡¨ğŸ‡³</span>
          <span class="flag">ğŸ‡ªğŸ‡¬</span>
          <span class="flag">ğŸ‡¬ğŸ‡·</span>
          <span class="flag">ğŸ‡®ğŸ‡ª</span>
          <span class="flag">ğŸ‡§ğŸ‡ª</span>
          <span class="flag">ğŸ‡¦ğŸ‡¹</span>
          <span class="flag">ğŸ‡¹ğŸ‡­</span>
          <span class="flag">ğŸ‡»ğŸ‡³</span>
          <span class="flag">ğŸ‡®ğŸ‡©</span>
          <span class="flag">ğŸ‡µğŸ‡­</span>
          <span class="flag">ğŸ‡²ğŸ‡¾</span>
          <span class="flag">ğŸ‡¸ğŸ‡¬</span>
          <span class="flag">ğŸ‡³ğŸ‡¿</span>
          <span class="flag">ğŸ‡¨ğŸ‡±</span>
          <span class="flag">ğŸ‡¨ğŸ‡´</span>
          <span class="flag">ğŸ‡µğŸ‡ª</span>
          <span class="flag">ğŸ‡ºğŸ‡¦</span>
          <span class="flag">ğŸ‡«ğŸ‡®</span>
          <span class="flag">ğŸ‡©ğŸ‡°</span>
          <span class="flag">ğŸ‡¨ğŸ‡¿</span>
          <span class="flag">ğŸ‡·ğŸ‡´</span>
          <span class="flag">ğŸ‡­ğŸ‡º</span>
          <span class="flag">ğŸ‡®ğŸ‡±</span>
          <span class="flag">ğŸ‡¸ğŸ‡¦</span>
          <span class="flag">ğŸ‡¦ğŸ‡ª</span>
          <span class="flag">ğŸ‡µğŸ‡°</span>
          <span class="flag">ğŸ‡§ğŸ‡©</span>
          <span class="flag">ğŸ‡³ğŸ‡¬</span>
        </div>
        <div class="start-content">
          <img src="/logo.jpg" alt="Pris en Flag" class="logo" />
          <div class="instructions">
            <p data-i18n="instruction1">A flag will appear on the left map, which progressively reveals the target country.</p>
            <p data-i18n="instruction2">Click on the right map to place your pin in the correct country.</p>
            <p data-i18n="instruction3">The faster you answer, the more points you earn!</p>
          </div>

          <div class="start-buttons">
            <!-- Daily Challenge -->
            <button id="daily-btn" class="btn btn-daily">
              <span class="daily-icon">ğŸ“…</span>
              <span data-i18n="dailyChallenge">Daily Challenge</span>
            </button>

            <!-- Play Button - opens modal -->
            <button id="play-btn" class="btn btn-primary btn-large">
              <span data-i18n="play">Play</span>
            </button>

            <!-- Explore Flags -->
            <button id="explore-btn" class="btn btn-explore">
              <span class="explore-icon">ğŸŒ</span>
              <span data-i18n="exploreFlags">Explore Flags</span>
            </button>
          </div>

          <p class="daily-info" data-i18n="dailyInfo">Same puzzle for everyone, resets at 9AM Paris time</p>
        </div>
      </div>

      <!-- Play Modal -->
      <div id="play-modal" class="modal-overlay hidden">
        <div class="modal-content">
          <button id="modal-close-btn" class="modal-close">&times;</button>
          <h2 data-i18n="selectRegion">Select Region</h2>

          <div class="modal-continent-buttons">
            <button class="continent-btn active" data-continent="all" data-i18n="allWorld">All World</button>
            <button class="continent-btn" data-continent="Europe" data-i18n="europe">Europe</button>
            <button class="continent-btn" data-continent="Asia" data-i18n="asia">Asia</button>
            <button class="continent-btn" data-continent="Africa" data-i18n="africa">Africa</button>
            <button class="continent-btn" data-continent="Americas" data-i18n="americas">Americas</button>
            <button class="continent-btn" data-continent="Oceania" data-i18n="oceania">Oceania</button>
          </div>

          <div class="modal-actions">
            <button id="modal-play-btn" class="btn btn-primary btn-large" data-i18n="play">Play</button>
          </div>

          <div class="modal-divider">
            <span>or</span>
          </div>

          <div class="challenge-section">
            <p class="challenge-label" data-i18n="createChallenge">Create a challenge for friends</p>
            <div class="challenge-link-container">
              <input type="text" id="challenge-link" class="challenge-link-input" readonly />
              <button id="generate-challenge-btn" class="btn btn-secondary btn-small" data-i18n="generate">Generate</button>
              <button id="copy-challenge-btn" class="btn btn-share btn-small hidden" data-i18n="copy">Copy</button>
            </div>
            <button id="play-challenge-btn" class="btn btn-challenge hidden">
              <span data-i18n="playChallenge">Play this Challenge</span>
            </button>
          </div>
        </div>
      </div>

      <!-- Game Screen -->
      <div id="game-screen" class="screen hidden">
        <header class="game-header">
          <button id="game-home-btn" class="home-btn" title="Back to Home">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path><polyline points="9 22 9 12 15 12 15 22"></polyline></svg>
          </button>
          <div class="score-display">
            <span class="label" data-i18n="score">Score</span>:
            <span id="total-score">0</span>
          </div>
          <div class="round-display">
            <span class="label" data-i18n="round">Round</span>
            <span id="current-round">1</span> / <span id="total-rounds">10</span>
          </div>
          <div class="timer-display">
            <span id="timer">30.0</span>s
          </div>
          <div class="hint-toggle">
            <label class="toggle-label">
              <input type="checkbox" id="hint-toggle" checked />
              <span class="toggle-slider"></span>
              <span class="toggle-text" data-i18n="hints">Hints</span>
            </label>
          </div>
        </header>

        <main class="game-container unified">
          <!-- Single unified map -->
          <div id="unified-map" class="map full-width"></div>

          <!-- Flag overlay on map -->
          <div class="flag-overlay">
            <img id="flag-image" src="" alt="Country flag" />
          </div>

          <!-- Country card (result display) -->
          <div id="country-card" class="country-card hidden">
            <h2 id="card-result-title" class="card-result-title">Correct!</h2>
            <img id="card-flag" class="card-flag" src="" alt="Country flag" />
            <h3 id="card-country-name" class="card-country-name"></h3>
            <div class="card-details">
              <div class="card-detail">
                <span class="card-label" data-i18n="capital">Capital</span>
                <span id="card-capital" class="card-value"></span>
              </div>
              <div class="card-detail">
                <span class="card-label" data-i18n="continent">Continent</span>
                <span id="card-continent" class="card-value"></span>
              </div>
              <div class="card-detail">
                <span class="card-label" data-i18n="region">Region</span>
                <span id="card-region" class="card-value"></span>
              </div>
            </div>
            <div class="card-score-breakdown">
              <div class="card-score-item">
                <span data-i18n="timeBonus">Time Bonus</span>
                <span id="card-time-bonus">+0</span>
              </div>
              <div class="card-score-item">
                <span data-i18n="hintBonus">Hint Bonus</span>
                <span id="card-hint-bonus">+0</span>
              </div>
              <div class="card-score-item">
                <span data-i18n="capitalBonus">Capital Bonus</span>
                <span id="card-capital-bonus">+0</span>
              </div>
              <div class="card-score-item total">
                <span data-i18n="roundScore">Round Score</span>
                <span id="card-round-score">0</span>
              </div>
            </div>
            <button id="card-next-btn" class="btn btn-primary" data-i18n="nextRound">Next Round</button>
          </div>

          <!-- Candidates panel (shown when hints reveal candidates) -->
          <div id="candidates-panel" class="candidates-panel hidden">
            <div class="candidates-list">
              <!-- Dynamically populated -->
            </div>
          </div>

          <!-- Answer controls floating at bottom -->
          <div class="answer-controls floating">
            <p id="selected-info" data-i18n="selectCountry">Click on the map to place your guess</p>
            <button id="submit-btn" class="btn btn-primary" disabled data-i18n="submit">Submit Answer</button>
          </div>
        </main>
      </div>

      <!-- Result Screen (shown after each round) -->
      <div id="result-overlay" class="overlay hidden">
        <div class="result-content">
          <h2 id="result-title">Correct!</h2>
          <p id="result-country"></p>
          <div class="score-breakdown">
            <div class="score-item">
              <span data-i18n="timeBonus">Time Bonus</span>:
              <span id="time-bonus">0</span>
            </div>
            <div class="score-item">
              <span data-i18n="hintBonus">Hint Bonus</span>:
              <span id="hint-bonus">0</span>
            </div>
            <div class="score-item">
              <span data-i18n="capitalBonus">Capital Bonus</span>:
              <span id="capital-bonus">0</span>
            </div>
            <div class="score-item total">
              <span data-i18n="roundScore">Round Score</span>:
              <span id="round-score">0</span>
            </div>
          </div>
          <button id="next-round-btn" class="btn btn-primary" data-i18n="nextRound">Next Round</button>
        </div>
      </div>

      <!-- End Screen -->
      <div id="end-screen" class="screen hidden">
        <div class="flags-bg">
          <span class="flag">ğŸ‡«ğŸ‡·</span>
          <span class="flag">ğŸ‡§ğŸ‡·</span>
          <span class="flag">ğŸ‡¯ğŸ‡µ</span>
          <span class="flag">ğŸ‡©ğŸ‡ª</span>
          <span class="flag">ğŸ‡®ğŸ‡³</span>
          <span class="flag">ğŸ‡¬ğŸ‡§</span>
          <span class="flag">ğŸ‡®ğŸ‡¹</span>
          <span class="flag">ğŸ‡ªğŸ‡¸</span>
          <span class="flag">ğŸ‡¨ğŸ‡¦</span>
          <span class="flag">ğŸ‡¦ğŸ‡º</span>
          <span class="flag">ğŸ‡²ğŸ‡½</span>
          <span class="flag">ğŸ‡°ğŸ‡·</span>
          <span class="flag">ğŸ‡³ğŸ‡±</span>
          <span class="flag">ğŸ‡¸ğŸ‡ª</span>
          <span class="flag">ğŸ‡¨ğŸ‡­</span>
          <span class="flag">ğŸ‡µğŸ‡¹</span>
          <span class="flag">ğŸ‡¦ğŸ‡·</span>
          <span class="flag">ğŸ‡¿ğŸ‡¦</span>
          <span class="flag">ğŸ‡³ğŸ‡´</span>
          <span class="flag">ğŸ‡µğŸ‡±</span>
          <span class="flag">ğŸ‡¹ğŸ‡·</span>
          <span class="flag">ğŸ‡·ğŸ‡º</span>
          <span class="flag">ğŸ‡¨ğŸ‡³</span>
          <span class="flag">ğŸ‡ªğŸ‡¬</span>
          <span class="flag">ğŸ‡¬ğŸ‡·</span>
          <span class="flag">ğŸ‡®ğŸ‡ª</span>
          <span class="flag">ğŸ‡§ğŸ‡ª</span>
          <span class="flag">ğŸ‡¦ğŸ‡¹</span>
          <span class="flag">ğŸ‡¹ğŸ‡­</span>
          <span class="flag">ğŸ‡»ğŸ‡³</span>
          <span class="flag">ğŸ‡®ğŸ‡©</span>
          <span class="flag">ğŸ‡µğŸ‡­</span>
          <span class="flag">ğŸ‡²ğŸ‡¾</span>
          <span class="flag">ğŸ‡¸ğŸ‡¬</span>
          <span class="flag">ğŸ‡³ğŸ‡¿</span>
          <span class="flag">ğŸ‡¨ğŸ‡±</span>
          <span class="flag">ğŸ‡¨ğŸ‡´</span>
          <span class="flag">ğŸ‡µğŸ‡ª</span>
          <span class="flag">ğŸ‡ºğŸ‡¦</span>
          <span class="flag">ğŸ‡«ğŸ‡®</span>
          <span class="flag">ğŸ‡©ğŸ‡°</span>
          <span class="flag">ğŸ‡¨ğŸ‡¿</span>
          <span class="flag">ğŸ‡·ğŸ‡´</span>
          <span class="flag">ğŸ‡­ğŸ‡º</span>
          <span class="flag">ğŸ‡®ğŸ‡±</span>
          <span class="flag">ğŸ‡¸ğŸ‡¦</span>
          <span class="flag">ğŸ‡¦ğŸ‡ª</span>
          <span class="flag">ğŸ‡µğŸ‡°</span>
          <span class="flag">ğŸ‡§ğŸ‡©</span>
          <span class="flag">ğŸ‡³ğŸ‡¬</span>
        </div>
        <div class="end-content">
          <h1 id="game-over-title" data-i18n="gameOver">Game Over!</h1>
          <div class="final-score">
            <span class="label" data-i18n="finalScore">Final Score</span>:
            <span id="final-score">0</span>
          </div>
          <div class="stats">
            <p><span id="correct-count">0</span> / 10 <span data-i18n="correctAnswers">correct answers</span></p>
          </div>

          <div class="recap-section">
            <h2 data-i18n="roundRecap">Round Recap</h2>
            <div id="recap-list" class="recap-list">
              <!-- Dynamically populated -->
            </div>
          </div>

          <div class="end-buttons">
            <button id="share-btn" class="btn btn-share">
              <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="18" cy="5" r="3"></circle><circle cx="6" cy="12" r="3"></circle><circle cx="18" cy="19" r="3"></circle><line x1="8.59" y1="13.51" x2="15.42" y2="17.49"></line><line x1="15.41" y1="6.51" x2="8.59" y2="10.49"></line></svg>
              <span data-i18n="shareResults">Share Results</span>
            </button>
            <button id="play-again-btn" class="btn btn-primary" data-i18n="playAgain">Play Again</button>
            <button id="end-home-btn" class="btn btn-secondary" data-i18n="backToHome">Back to Home</button>
          </div>
        </div>
      </div>

      <!-- Glossary Screen -->
      <div id="glossary-screen" class="screen hidden">
        <header class="glossary-header">
          <button id="glossary-home-btn" class="home-btn" title="Back to Home">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path><polyline points="9 22 9 12 15 12 15 22"></polyline></svg>
          </button>
          <h1 data-i18n="exploreFlags">Explore Flags</h1>
          <span id="glossary-count" class="glossary-count"></span>
        </header>

        <div class="glossary-controls">
          <input type="text" id="glossary-search" class="glossary-search" placeholder="Search countries..." data-i18n-placeholder="searchCountries" />
          <div class="glossary-filters">
            <button class="filter-btn active" data-continent="all" data-i18n="all">All</button>
            <button class="filter-btn" data-continent="Europe" data-i18n="europe">Europe</button>
            <button class="filter-btn" data-continent="Asia" data-i18n="asia">Asia</button>
            <button class="filter-btn" data-continent="Africa" data-i18n="africa">Africa</button>
            <button class="filter-btn" data-continent="Americas" data-i18n="americas">Americas</button>
            <button class="filter-btn" data-continent="Oceania" data-i18n="oceania">Oceania</button>
          </div>
        </div>

        <main class="glossary-content">
          <div id="glossary-list" class="glossary-list">
            <!-- Dynamically populated -->
          </div>
        </main>
      </div>
    </div>
    <script type="module" src="/src/main.js"></script>
  </body>
</html>
